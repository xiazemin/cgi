# POST程序示例

void unencode\(char \*src, char \*last, char \*dest\) { // str = hello+there%21 此处跳过data=... // last = ; 已到末尾. // dest= ; 空串. //解码原则 //原则1: '+'变' '; //原则2: '%xx'变成对应的16进制ASCII码值; for\(; src != last; src++, dest++\) { if\(\*src == '+'\) { \*dest = ' '; } else if\(\*src == '%'\) { int code; if\(sscanf\(src+1, "%2x", &code\) != 1\) { code = ' '; } \*dest = code; src +=2; } else { \*dest = \*src; } } \*dest = '\n'; \*++dest = '\0'; } intmain\(void\) { char \*lenstr; char input\[MAXINPUT\], data\[MAXINPUT\]; long len; printf\("%s%c%c\n","Content-Type:text/html;charset=iso-8859-1",13,10\); printf\("&lt;TITLE&gt;Response&lt;/TITLE&gt;\n"\); lenstr =getenv\("CONTENT\_LENGTH"\); printf\("CONTENT\_LENGTH =%s\n",lenstr\); if\(lenstr == NULL \|\|sscanf\(lenstr,"%ld",&len\)!=1 \|\| len &gt; MAXLEN\) { printf\("&lt;P&gt;Error ininvocation - wrong FORM probably."\); } else { FILE \*f; fgets\(input, len+1, stdin\); //add by ycy从输入流中获取字符串. unencode\(input+EXTRA, input+len,data\); f = fopen\(DATAFILE,"a"\); if\(f == NULL\) { printf\("&lt;P&gt;Sorry,cannot store your data."\); } else { fputs\(data, f\); //add byycy 将数据存储在对对应的文件中. } fclose\(f\); printf\("&lt;P&gt;Thank you!Your contribution has been stored."\); } return 0; }

